<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>Hmong First Baptist Church – Praise & Worship</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="color-scheme" content="dark light" />
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <header class="site-header">
    <div class="container nav">
      <a class="brand" href="#top">Hmong First Baptist Church – Praise & Worship</a>
      <nav>
        <a href="#announcements">Announcements</a>
        <a href="#members">Members</a>
        <a href="#bible-study">Bible Study</a>
        <a href="#setlists">Setlists</a>
        <a href="#analytics">Song Analytics</a>
      </nav>
    </div>
  </header>

  <main id="top">
    <!-- Top board: Announcements • Reminders • Members -->
    <section id="top-cards" class="section">
      <div class="container">
        <div class="grid three">
          <!-- Announcements -->
          <article class="card" id="announcements">
            <h2 class="section-title">Announcements</h2>
            <div id="announcements-table">Loading announcements…</div>
          </article>

          <!-- Reminders -->
          <aside class="card reminder-card" id="reminders">
            <h2 class="section-title">Reminders</h2>
            <ul class="reminder-list">
              <li>
                <div class="reminder-label">Thursday Practice</div>
                <div class="reminder-time">6:00 PM – 8:00 PM</div>
              </li>
              <li>
                <div class="reminder-label">Sunday Practice</div>
                <div class="reminder-time">8:40 AM – 9:30 AM</div>
              </li>
            </ul>
            <p class="reminder-note dim small">
              Please arrive 5 minutes early to be ready to begin practice.
            </p>
          </aside>

          <!-- Members -->
          <article class="card" id="members">
            <h2 class="section-title">Worship Team Members</h2>
            <div id="members-table">Loading members…</div>
            <p class="dim small">Source: <code>members/members.xlsx</code></p>
          </article>
        </div>
      </div>
    </section>

    <!-- Bible Study -->
    <section id="bible-study" class="section alt">
      <div class="container">
        <h2 class="section-title">Bible Study</h2>
        <div id="bible-study-table" class="card">Loading Bible study…</div>
        <p class="dim small">Source: <code>bible_study/bible_study.xlsx</code></p>
      </div>
    </section>

    <!-- Setlists -->
    <section id="setlists" class="section alt">
      <div class="container">
        <h2 class="section-title">Setlists</h2>
        <div class="grid two">
          <article class="card">
            <h3>This Coming Week</h3>
            <p id="next-date" class="meta">Detecting next service…</p>
            <div id="next-sermon" class="meta"></div>
            <div id="next-setlist">Please wait…</div>
          </article>

          <article class="card">
            <h3>Last Week</h3>
            <p id="last-date" class="meta">—</p>
            <div id="last-sermon" class="meta"></div>
            <div id="last-setlist">Please wait…</div>
          </article>
        </div>
      </div>
    </section>

    <!-- Song analytics & library -->
    <section id="analytics" class="section alt">
      <div class="container">
        <h2 class="section-title">Song Analytics</h2>
        <div class="grid two">
          <article class="card">
            <h3>Top 5 – Most Popular</h3>
            <ol id="top5" class="ranked"><li class="dim">No data yet.</li></ol>
          </article>
          <article class="card">
            <h3>Top 5 – Least Popular</h3>
            <ol id="bottom5" class="ranked"><li class="dim">No data yet.</li></ol>
          </article>
        </div>

        <div class="grid two charts">
          <article class="card">
            <h3>Top Songs (Bar)</h3>
            <div class="chart-wrap"><canvas id="barChart"></canvas></div>
          </article>
          <article class="card">
            <h3>Top Songs (Pie)</h3>
            <div class="chart-wrap"><canvas id="pieChart"></canvas></div>
          </article>
        </div>

        <div class="card">
          <h3>Song Library (Current Year)</h3>
          <p class="dim small">Unique songs and play counts this year.</p>
          <div id="library-table">Building library…</div>
        </div>
      </div>
    </section>
  </main>

  <footer class="site-footer">
    <div class="container">
      <p class="dim">© <span id="year"></span> Hmong First Baptist Church • Praise & Worship Team</p>
    </div>
  </footer>

  <!-- Libraries -->
  <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>
  <script src="script.js"></script>
  <script>document.getElementById('year').textContent = new Date().getFullYear();</script>
</body>
</html>
